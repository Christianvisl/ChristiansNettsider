<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visittkort</title>
</head>

<style>
    #kortetsUtseende {
        border-radius: 20px;
        background-color: white;
        border: solid 3px black;
        padding: 50px;
        text-align: center;
        align-items: center;
        width: 500px;
        margin: auto;
        display: flex;
        flex-direction: column;
    }

    #kortetsUtseende>input {
        margin-bottom: 10px;
    }

    #kortDiv {
        border-radius: 20px;
        background-color: white;
        border: solid 3px black;
        padding: 50px;
        text-align: center;
        align-items: center;
        width: fit-content;
        margin: auto;
        display: none;
        flex-direction: column;
    }

    #kortDiv>div {
        margin: 40px;
    }

    #kortFyllDiv {
        border-radius: 20px;
        background-color: white;
        border: solid 3px black;
        padding: 20px;
        text-align: center;
        align-items: center;
        width: fit-content;
        margin: auto;
        display: none;
        flex-direction: column;
    }

    #styleBokseneDiv2 {
        flex-direction: column;
        display: none;
        text-align: center;
        align-items: center;
    }

    #styleBokseneDiv2>label {
        margin-top: 20px;
    }

    #tekstFontInput {
        text-align: left;
    }

    div>label {
        font-weight: bold;
    }

    #kortNr2 {
        display: none;
        top: 16.5px;
        left: 16.5px;
        position: absolute;
    }
</style>

<body>
    <div id="kortetsUtseende">
        <h2>Kortets utseende</h2>
        <label for="Bakgrunnsfarge">Bakgrunnsfarge:</label>
        <input type="color" id="Bakgrunnsfarge" name="Bakgrunnsfarge" required>

        <label for="Hoyde">Høyde (min 100px, max 400px):</label>
        <input type="range" id="Hoyde" name="Hoyde" min="100" max="400" required>

        <label for="Bredde">Bredde (min 100px, max 600px):</label>
        <input type="range" id="Bredde" name="Bredde" min="100" max="600" required>

        <label for="Kantlinjefarge">Kantlinjefarge:</label>
        <input type="color" id="Kantlinjefarge" name="Kantlinjefarge" required>

        <label for="Kantlinjebredde">Kantlinjebredde (min 1px, max 20px):</label>
        <input type="range" id="Kantlinjebredde" name="Kantlinjebredde" min="1" max="20" required>

        <button onclick="lagreUtseende()">Lagre utseende</button>
    </div>

    <div id="kortDiv">
        <h1>Kortet ditt</h1>
        <button id="nyeTekstbokser" onclick="nyeTekstbokser()">Legg til tekstbokser på kortet</button>
        <div id="kort"></div>
    </div>

    <div id="kortFyllDiv">


        <div id="antallInputDiv">
            <h1>Legg til nye tekstbokser</h1>
            <label for="antallInput">Velg hvor mange tekstbokser du ønsker:</label>
            <input id="antallBokser" type="number" name="antallInput" min="1" max="8" placeholder="min 1, max 8">
            <button id="lagreAntallBokser" onclick="lagreAntallBokser()">Lagre antall bokser</button>
        </div>

        <div id="styleHverTekstboks">
            <div id="styleBokseneDiv1">
                <h1 id="overskriftStyleHverTekstboks">Style boks nummer 1 av dine bokser</h1>
                <label for="inputType">Velg mellom en av følgende input-typer:</label>
                <select id="valgInputType" name="inputType">
                    <option value="text">Tekst</option>
                    <option value="tel">Nummer</option>
                    <option value="date">Dato</option>
                    <option value="email">Email</option>
                    <option value="file">Bilde</option>
                </select>
                <button id="lagInputenBtn" onclick="lagInputen()">Lag inputen</button>
                <br><br>
            </div>

            <div id="styleBokseneDiv2">
                <label for="tekstFarge">Farge på teksten: </label>
                <input id="tekstFargeInput" name="tekstFarge" type="color">

                <label for="tekstStorrelse">Storrelse på teksten (min 5px, max 15px): </label>
                <input id="tekstStorrelseInput" name="tekstStorrelse" type="range" min="5" max="15">


                <label for="tekstFont">Tekst-font:</label>
                <form id="tekstFontInput" name="tekstFont">
                    <input type="radio" id="Arial, Helvetica, sans-serif" name="tekstFont"
                        value="Arial, Helvetica, sans-serif">
                    <label style="font-family: Arial, Helvetica, sans-serif;" for="Arial, Helvetica, sans-serif">Arial,
                        Helvetica, sans-serif</label><br>

                    <input type="radio" id="Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif" name="tekstFont"
                        value="Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif">
                    <label style="font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;"
                        for="Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif">Impact, Haettenschweiler, 'Arial
                        Narrow Bold', sans-serif</label><br>

                    <input type="radio" id="monospace" name="tekstFont" value="monospace">
                    <label style="font-family: monospace;" for="monospace">monospace</label>
                </form>


                <button id="lagreElementetBtn" onclick="lagreElementet()" style="margin-top: 20px;">Lagre
                    elementet</button>
            </div>
        </div>
    </div>
    <div id="kortNr2"></div>



    <script>
        let kortetsUtseende = document.getElementById("kortetsUtseende")
        let kortDiv = document.getElementById("kortDiv");
        let kortet = document.getElementById("kort");


        let kortFyllDiv = document.getElementById("kortFyllDiv");
        let antallInputDiv = document.getElementById("antallInputDiv");

        let valgInputType = document.getElementById("valgInputType");
        let styleHverTekstboks = document.getElementById("styleHverTekstboks");
        let antallBokser = document.getElementById("antallBokser");
        let overskriftStyleHverTekstboks = document.getElementById("overskriftStyleHverTekstboks");

        let styleBokseneDiv1 = document.getElementById("styleBokseneDiv1");
        let styleBokseneDiv2 = document.getElementById("styleBokseneDiv2");
        let lagInputenBtn = document.getElementById("lagInputenBtn");
        let lagreElementetBtn = document.getElementById("lagreElementetBtn");

        let kortNr2 = document.getElementById("kortNr2");

        let Bakgrunnsfarge = document.getElementById("Bakgrunnsfarge");
        let Hoyde = document.getElementById("Hoyde");
        let Bredde = document.getElementById("Bredde");
        let Kantlinjefarge = document.getElementById("Kantlinjefarge");
        let Kantlinjebredde = document.getElementById("Kantlinjebredde");


        let tekstFargeInput = document.getElementById("tekstFargeInput");
        let tekstStorrelseInput = document.getElementById("tekstStorrelseInput");
        let tekstFontInput = document.getElementById("tekstFontInput");

        let bokserArray = document.getElementsByClassName("bokser");

        let antallLagdeBokser = 0;
        let antallBokserIgjen = 0;
        let index = 0;


        function lagreUtseende() {
            kortetsUtseende.style.display = "none";
            kortDiv.style.display = "flex";

            kortet.style.backgroundColor = Bakgrunnsfarge.value;
            kortet.style.height = Hoyde.value + "px";
            kortet.style.width = Bredde.value + "px";
            kortet.style.borderColor = Kantlinjefarge.value;
            kortet.style.borderWidth = Kantlinjebredde.value + "px";
            kortet.style.borderStyle = "solid";

            kortNr2.style.backgroundColor = Bakgrunnsfarge.value;
            kortNr2.style.height = Hoyde.value + "px";
            kortNr2.style.width = Bredde.value + "px";
            kortNr2.style.borderColor = Kantlinjefarge.value;
            kortNr2.style.borderWidth = Kantlinjebredde.value + "px";
            kortNr2.style.borderStyle = "solid";
        }

        function nyeTekstbokser() {
            kortDiv.style.display = "none";
            kortFyllDiv.style.display = "flex";
            styleHverTekstboks.style.display = "none";
        }

        function lagreAntallBokser() {
            antallLagdeBokser = antallBokser.value;
            antallBokserIgjen = antallLagdeBokser - 1;

            if (antallLagdeBokser < 8 && antallLagdeBokser > 0) {
                antallInputDiv.style.display = "none";
                styleHverTekstboks.style.display = "block";

            }
            else if (antallLagdeBokser < 1) {
                alert("Du kan ikke lage så få bokser");
            }
            else {
                alert("Du kan ikke lage så mange bokser");
            }
        }

        function lagInputen() {
            lagInputenBtn.disabled = true;
            var nyBoks = document.createElement("input")
            nyBoks.type = valgInputType.value;
            nyBoks.placeholder = "Fyll inn her";
            nyBoks.className = "bokser";

            document.getElementById("styleBokseneDiv1").appendChild(nyBoks);
            styleBokseneDiv2.style.display = "flex";
        }

        function lagreElementet() {
            if (antallBokserIgjen > 0 && bokserArray[index].value != "") {

                lagTekstboksAvInput(index)

                antallInputDiv.style.display = "none";
                styleHverTekstboks.style.display = "block";
                styleBokseneDiv2.style.display = "none";
                lagInputenBtn.disabled = false;
                bokserArray[index].style.display = "none";
                index++;

                antallBokserIgjen -= 1;
                overskriftStyleHverTekstboks.innerHTML = "Style boks nummer " + (antallLagdeBokser - antallBokserIgjen) + " av " + antallLagdeBokser + " totale bokser";
            }

            else if (bokserArray[index].value == "") {
                alert("Du må skrive noe i inputen!!")
            }

            else if (antallBokserIgjen == 0) {
                lagTekstboksAvInput(index);
                styleHverTekstboks.style.display = "none";
                kortFyllDiv.style.display = "none";
                kortNr2.style.display = "block";

                igangsettStartModusFunksjoner(antallLagdeBokser)
            }
        }

        function lagTekstboksAvInput(nummer) {

            var nyTekstBoks = document.createElement("p");
            nyTekstBoks.innerHTML = bokserArray[index].value;
            nyTekstBoks.style.color = tekstFargeInput.value;
            nyTekstBoks.style.fontSize = tekstStorrelseInput.value;
            nyTekstBoks.style.fontFamily = document.querySelector("input[name='tekstFont']:checked").value;
            nyTekstBoks.id = "tekstboksNr" + String(index);

            document.getElementById("kortNr2").appendChild(nyTekstBoks);
            document.getElementById("tekstboksNr" + index).style.position = "inherit";
        }

        function igangsettStartModusFunksjoner(verdi) {
            if (verdi > 0) {
                draModus(document.getElementById("tekstboksNr0"));
                if (verdi > 1) {
                    draModus(document.getElementById("tekstboksNr1"));
                    if (verdi > 2) {
                        draModus(document.getElementById("tekstboksNr2"));
                        if (verdi > 3) {
                            draModus(document.getElementById("tekstboksNr3"));
                            if (verdi > 4) {
                                draModus(document.getElementById("tekstboksNr4"));
                                if (verdi > 5) {
                                    draModus(document.getElementById("tekstboksNr5"));
                                    if (verdi > 6) {
                                        draModus(document.getElementById("tekstboksNr6"));
                                        if (verdi > 7) {
                                            draModus(document.getElementById("tekstboksNr7"));
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        /* 
            Funksjonen draModus blir utført når man trykker og drar et av elementene som er på visittkortet.
             Målet med funksjonen er å gjøre det mulig å trykke og dra et element på visittkortet rundt.
             Funksjonen starter med å definere noen variabler, som jeg bruker som posisjon.
             Den sjekker deretter om elementet, som ligger under diven, eksisterer. Hvis den gjør det, så settes en 
             eventlistener (som utføres når du trykker ned på elementet) til elementet. Hvis elementet ikke eksisterer, så settes 
             eventlisteneren til diven. Funksjonen startDraModus blir utført når man trykker ned på elementet, eller elementet med navnet likt elementet + "header".
         */

        function draModus(elementet) {

            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

            elementet.onmousedown = startDraModus;


            /*
                Denne funksjonen blir utført når man trykker ned på et av elementene som ble definert ovenfor.
                event.preventDefault() hindrer at f.eks markering vil skje når man drar på elementet.
                Funksjonen lagrer y-og x-posisjonen til elementet som blir trykket ned.
                Deretter setter den en eventlistener til elementet, som gjør at når du ikke trykker ned på elementet lengre, så
                kjøres funksjonen draModusAv (som gjør at man slipper elementet).
                En annen evenlistener blir satt til elementet, som gjør at når du rører rundt på musen, så utføres funksjonen draElementet().
                Så draElemenetet blir kjørt hele tiden mens du rører på musen din mens du holder et element, litt som en while-løkke.
            */

            function startDraModus(event) {
                event.preventDefault();
                pos3 = event.clientX;
                pos4 = event.clientY;
                document.onmouseup = draModusAv;
                document.onmousemove = draElementet;
            }

            /*    
                Funksjonen draElementet er en funksjon som blir utført når man aktivt drar rundt på elementet.
                Funksjonen gjør at når du drar elementet rundt, så føler elementer etter. Det gjør også slikt at elementet blir sittende igjen 
                der du slipper elementet.
                event.preventDefault() har fortsatt samme funksjon, at den hindrer f.eks. markering av tekst.
                Variabelen pos1 blir satt til pos3, som er startposisjonen, - event.clientX, slik at når du slipper elementet, så 
                er den nye X-posisjonen lagret.
                Variabelen pos2 blir satt til pos4, som er startposisjonen, - event.clientY, slik at når du slipper elementet, så 
                er den nye Y-posisjonen lagret.
                Så blir pos3 satt til den nye posisjonen, slik at når funksjonen blir kjørt på nytt, så har den riktig startpunkt.
                Så blir pos4 satt til den nye posisjonen, slik at når funksjonen blir kjørt på nytt, så har den riktig startpunkt.
                Derettet blir elementets "top" posisjon satt til elementets "offsetTop", som git hvor langt elementet er fra toppen av skjermen, minus 
                den nye posisjonen 2, slik at elementet får en ny x-posisjon. 
                Derettet blir elementets "left" posisjon satt til elementets "offsetLeft", som git hvor langt elementet er fra venste side av skjermen, 
                minus den nye posisjonen 2, slik at elementet får en ny y-posisjon. 
                Disse to linjene skaper effekten av at du drar elementet rundt på en smooth måte.
            */

            function draElementet(event) {
                event.preventDefault();
                pos1 = pos3 - event.clientX;
                pos2 = pos4 - event.clientY;
                pos3 = event.clientX;
                pos4 = event.clientY;
                elementet.style.top = (elementet.offsetTop - pos2) - 16.5 + "px";
                elementet.style.left = (elementet.offsetLeft - pos1) + "px";
            }


            /* 
                Funksjonen draModusAv blir kjørt når man slipper elementet, "onmouseup".
                Funksjonen gjør at når du slipper elementet, så slipper du faktisk elementet.
                De to linjene bare tar bort eventlistenersene "onmouseup" og "onmousemove" til hele dokumentet (men det virker for brukeren
                som at det bare var for elementet). 
            */

            function draModusAv() {
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }
    </script>
</body>

</html>